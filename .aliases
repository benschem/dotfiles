# Note to self: only add aliases you actually use
alias aliases='command -v bat >/dev/null && bat --language=sh ~/.aliases --style=plain --paging=never || (cat ~/.aliases; echo ""; echo "# [INFO] bat not found. Run: brew install bat for syntax highlighting")'

# Dev
alias be='bundle exec'

# Git push/pull
alias gs='git status -sb' # Small status with symbols
alias gst='git status'
alias gpl='git pull'
alias gp='git push'
alias gpf='git push --force-with-lease'
alias gri='git rebase -i'
alias grc='git rebase --continue'
alias gra='git rebase --abort'
alias gpu='git push -u origin HEAD'

## Git branching
alias gco='git switch'          # more modern git checkout
alias gcb='git switch --create' # more modern git checkout --branch

## Git diffing
alias gd='git diff'
alias gdt='git difftool'
alias gstat='git diff --stat'
alias ghist='git log --follow --' # view full history of a single file (usage: ghist path/to/file)

## Git committing
alias ga='git add'
alias gap='git add --patch'
alias gc='git commit'
alias gcm='git commit --message'
alias gca='git commit --amend && (git rev-parse --abbrev-ref --symbolic-full-name @{u} >/dev/null 2>&1 && [[ $(git rev-list --count @{u}..HEAD) -eq 0 ]] && echo "[INFO] It was not safe to amend - this commit has already been pushed. Pushing now will rewrite history. Undo and make a new commit or if you must push run: \"git push --force-with-lease\"" || echo "[INFO] It was safe to amend - this commit has not been pushed yet (or no upstream is set)")'
alias gcan='git commit --amend --no-edit && (git rev-parse --abbrev-ref --symbolic-full-name @{u} >/dev/null 2>&1 && [[ $(git rev-list --count @{u}..HEAD) -eq 0 ]] && echo "[INFO] It was not safe to amend - this commit has already been pushed. Pushing now will rewrite history. Undo and make a new commit or if you must push run: \"git push --force-with-lease\"" || echo "[INFO] It was safe to amend - this commit has not been pushed yet (or no upstream is set)")'
alias grs='git restore --staged'
alias guc='git reset --soft HEAD~1' # uncommit - removes commit and moves changes back to staging
alias grvt='git revert HEAD'  # create a new commit that undoes the changes made by the last commit

## Git logging
alias glo='git log --oneline --decorate'
alias glog='git log --oneline --decorate --graph'
alias gloga='git log --graph --pretty=format:"%Cred%h%Creset - %s %Cgreen(%ar) %C(bold blue)%an%Creset %C(yellow)%d%Creset"' # http://www.jukie.net/bart/blog/pimping-out-git-log
alias greflog='git reflog --date=relative --pretty=format:"%C(yellow)%h%Creset %Cgreen(%cr)%Creset %Creset%gs"'

# Shell aliases (replace OMZ's common-aliases plugin)
alias ls='ls -AFG'                   # list all files, trailing slashes, color
alias lss='ls | sort --ignore-case'  # list all files, trailing slashes, sorted by
alias la="echo 'permissions|lnk|ownr|group| size |  last mod  |  pathname' && ls -AlhFG" # list all files, long format, human-readable file sizes, trailing slashes, color
alias ldot='ls -ldG .*'             # list metadata for dotfiles/directories only (not contents)
alias lsize='du -sh .'              # size of current directory, human-readable
alias grep='grep --color'           # highlight matching text in grep output
alias hgrep='fc -El 0 | grep'       # searches for a given word in the previously used commands
alias ff='find . -type f -name'     # find files with given name
alias help='man'                    # use 'help' to open manual pages
alias tree='tree -a -C -d --sort=name --dirsfirst -L'
alias reload='source ~/.zshrc'
alias allusers="awk -F':' '{ print \$1 }' /etc/passwd"
alias humans="awk -F: -v min=\$(awk '/^UID_MIN/ { print \$2 }' /etc/login.defs) '{ if (\$3 >= min) print \$1 }' /etc/passwd"

# Networking
alias lt='localtunnel'                     # expose a local port to the internet
alias myip='curl https://ipinfo.io/json'   # public IP info (use /ip for raw IP only)
alias serve='ruby -run -e httpd . -p 8000' # static file server from current directory
alias ports='lsof -i -P -n | grep LISTEN'  # show listening TCP ports with numeric IPs/ports
alias sniff='sudo lsof -i -P -n'           # show all active network sockets (requires sudo)

# Clarity project manager aliases
alias urgent='clarity list --filter urgency=high --filter urgency=medium --filter urgency=low --sort urgency'
